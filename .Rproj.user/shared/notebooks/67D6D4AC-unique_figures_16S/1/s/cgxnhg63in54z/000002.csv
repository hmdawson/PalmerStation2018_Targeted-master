"0","#for bacteria"
"0","taxa.b <- read.csv('2021.02.15_dawson.bacteria.taxon_map.csv', header = T, row.names = 1, as.is = T)"
"0","map.b <- read.csv('2021.02.15_dawson.bacteria.seq_edge_map.csv')"
"0","#for archaea"
"0","taxa.a <- read.csv('2021.02.15_dawson.archaea.taxon_map.csv', header = T, row.names = 1, as.is = T)"
"0","map.a <- read.csv('2021.02.15_dawson.archaea.seq_edge_map.csv')"
"0",""
"0","#combine"
"0",""
"0","taxa <- rbind(taxa.b,taxa.a)"
"0","map <- rbind(map.b, map.a)"
"0","rownames(map) <- map[,1]"
"0","map <- map[,-1]"
"0","rm(taxa.a,taxa.b,map.a,map.b)"
"0",""
"0","#sample metadata"
"0","metadata <- read.csv('dawson_metadata.csv',header = T)"
"0","metadata <- metadata[1:63 ,]"
"0",""
"0","#create mapfile combining taxa and map"
"0","mapfile <- map[colnames(unique),]"
"0","Yep <- map[colnames(unique), 'global_edge_num']"
"0","tax <- taxa[Yep, 'taxon']"
"0","tax[tax == """"] <- 'Bacteria'"
"0","tax[is.na(tax)] <- 'Bacteria'"
"0","mapfile$Taxa <- tax"
"0","Fam <-taxa[Yep, 'family']"
"0","Fam[Fam == """"] <- 'Bacteria'"
"0","Fam[is.na(Fam)] <- 'Bacteria'"
"0","mapfile$Family <- Fam"
"0","Phylum <- taxa[Yep, 'phylum']"
"0","Phylum[Phylum == """"] <- 'Bacteria'"
"0","Phylum[is.na(Phylum)] <- 'Bacteria'"
"0","mapfile$Phylum <- Phylum"
"0","rm(Fam, Phylum, Yep)"
"0",""
