"0","#for bacteria"
"0","taxa.b <- read.csv('2021.02.15_dawson.bacteria.taxon_map.csv', header = T, row.names = 1, as.is = T)"
"0","map.b <- read.csv('2021.02.15_dawson.bacteria.seq_edge_map.csv')"
"0","#for archaea"
"0","taxa.a <- read.csv('2021.02.15_dawson.archaea.taxon_map.csv', header = T, row.names = 1, as.is = T)"
"0","map.a <- read.csv('2021.02.15_dawson.archaea.seq_edge_map.csv')"
"0",""
"0","#combine"
"0",""
"0","taxa <- rbind(taxa.b,taxa.a)"
"0","map <- rbind(map.b, map.a)"
"0","rownames(map) <- map[,1]"
"0","map <- map[,-1]"
"0","rm(taxa.a,taxa.b,map.a,map.b)"
"0",""
"0","#sample metadata"
"0","metadata <- read.csv('dawson_metadata.csv',header = T)"
"0","metadata <- metadata[1:63 ,]"
"0",""
"0","#create mapfile combining taxa and map"
"0","mapfile <- map[colnames(unique),]"
"0","Yep <- map[colnames(unique), 'global_edge_num']"
"0","tax <- taxa[Yep, 'taxon']"
"0","tax[tax == """"] <- 'Unclassified'"
"0","tax[is.na(tax)] <- 'Unclassified'"
"0","mapfile$Taxa <- tax"
"0","Fam <-taxa[Yep, 'family']"
"0","Fam[Fam == """"] <- 'Unclassified'"
"0","Fam[is.na(Fam)] <- 'Unclassified'"
"0","mapfile$Family <- Fam"
"0","Phylum <- taxa[Yep, 'phylum']"
"0","Phylum[Phylum == """"] <- 'Unclassified'"
"0","Phylum[is.na(Phylum)] <- 'Unclassified'"
"0","mapfile$Phylum <- Phylum"
"0",""
"0","#if problem arises from mapfile, comment out from here below"
"0","Superkingdom <- taxa[Yep, 'superkingdom']"
"0","Superkingdom[Superkingdom == """"] <- 'Unclassified'"
"0","Superkingdom[is.na(Superkingdom)] <- 'Unclassified'"
"0","mapfile$Superkingdom <- Superkingdom"
"0",""
"0","Clade <- taxa[Yep, 'clade']"
"0","Clade[Clade == """"] <- 'Unclassified'"
"0","Clade[is.na(Clade)] <- 'Unclassified'"
"0","mapfile$Clade <- Clade"
"0",""
"0","Class <- taxa[Yep, 'class']"
"0","Class[Class == """"] <- 'Unclassified'"
"0","Class[is.na(Class)] <- 'Unclassified'"
"0","mapfile$Class <- Class"
"0",""
"0","Order <- taxa[Yep, 'order']"
"0","Order[Order == """"] <- 'Unclassified'"
"0","Order[is.na(Order)] <- 'Unclassified'"
"0","mapfile$Order <- Order"
"0",""
"0","Genus <- taxa[Yep, 'genus']"
"0","Genus[Genus == """"] <- 'Unclassified'"
"0","Genus[is.na(Genus)] <- 'Unclassified'"
"0","mapfile$Genus <- Genus"
"0",""
"0","Species <- taxa[Yep, 'species']"
"0","Species[Species == """"] <- 'Unclassified'"
"0","Species[is.na(Species)] <- 'Unclassified'"
"0","mapfile$Species <- Species"
"0",""
"0","Strain <- taxa[Yep, 'strain']"
"0","Strain[Strain == """"] <- 'Unclassified'"
"0","Strain[is.na(Strain)] <- 'Unclassified'"
"0","mapfile$Strain <- Strain"
"0",""
"0","rm(Fam, Phylum, Yep, Superkingdom, Clade, Class, Order, Genus, Species, Strain)"
"0",""
