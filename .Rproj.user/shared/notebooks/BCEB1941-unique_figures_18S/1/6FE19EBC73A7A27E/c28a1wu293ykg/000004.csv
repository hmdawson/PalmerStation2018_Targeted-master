"0","library(ggplot2)"
"0","library(tidyr)"
"0","#change ASV sequences to Phylum classification "
"0","s <- unique.select"
"0","index <- as.data.frame(colnames(s))"
"0","index$phylum <- mapfile[index$`colnames(s)`, 'Phylum']"
"0","colnames(s) <- 1:length(s)"
"0",""
"0","#melt for bar plot"
"0",""
"0","s.melt <- melt(s)"
"2","No id variables; using all as measure variables
"
"0","s.melt$SampleID <- rownames(s)"
"0","s.melt <- s.melt %>% filter(value != 0)"
"0","s.melt$taxa <- index[s.melt$variable, 'phylum']"
"0",""
"0",""
"0","bp <- function(x, y){"
"0","ggplot() +"
"0","geom_bar(aes( y = value, x = SampleID, fill= taxa), data = x, stat = ""identity"")+ "
"0","  theme(axis.text.x = element_text(angle = 90)) +"
"0","   labs(title = y) +"
"0","   labs(x = """", y = ""Relative Abundance (%)"", fill = ""class"") "
"0","}  "
"0",""
"0","bp(s.melt, ""18S Relative Abundance"")"
"0",""
