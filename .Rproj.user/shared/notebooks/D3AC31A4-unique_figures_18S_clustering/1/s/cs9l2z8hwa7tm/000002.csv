"0",""
"0","taxa <- read.csv('2021.02.15_dawson.eukarya.taxon_map.csv', header = T, row.names = 1, as.is = T)"
"0","map <- read.csv('2021.02.15_dawson.eukarya.seq_edge_map.csv',header = T, row.names = 1, as.is = T)"
"0",""
"0",""
"0","#sample metadata"
"0","metadata <- read.csv('dawson_metadata.csv',header = T)"
"0","metadata <- metadata[1:63 ,]"
"0",""
"0","#create mapfile combining taxa and map"
"0","mapfile <- map[colnames(unique),]"
"0","Yep <- map[colnames(unique), 'global_edge_num']"
"0","tax <- taxa[Yep, 'taxon']"
"0","tax[tax == """"] <- 'Unclassified Eukaryota'"
"0","tax[is.na(tax)] <- 'Unclassified Eukaryota'"
"0","mapfile$Taxa <- tax"
"0","Fam <-taxa[Yep, 'family']"
"0","Fam[Fam == """"] <- 'Unclassified Eukaryota'"
"0","Fam[is.na(Fam)] <- 'Unclassified Eukaryota'"
"0","mapfile$Family <- Fam"
"0","Phylum <- taxa[Yep, 'division']"
"0","Phylum[Phylum == """"] <- 'Unclassified Eukaryota'"
"0","Phylum[is.na(Phylum)] <- 'Unclassified Eukaryota'"
"0","mapfile$Phylum <- Phylum"
"0",""
"0","#if problem arises from mapfile, comment out from here below"
"0","Kingdom <- taxa[Yep, 'kingdom']"
"0","Kingdom[Kingdom == """"] <- 'Unclassified Eukaryota'"
"0","Kingdom[is.na(Kingdom)] <- 'Unclassified Eukaryota'"
"0","mapfile$Kingdom <- Kingdom"
"0",""
"0","Supergroup <- taxa[Yep, 'supergroup']"
"0","Supergroup[Supergroup == """"] <- 'Unclassified Eukaryota'"
"0","Supergroup[is.na(Supergroup)] <- 'Unclassified Eukaryota'"
"0","mapfile$Supergroup <- Supergroup"
"0",""
"0","Class <- taxa[Yep, 'class']"
"0","Class[Class == """"] <- 'Unclassified Eukaryota'"
"0","Class[is.na(Class)] <- 'Unclassified Eukaryota'"
"0","mapfile$Class <- Class"
"0",""
"0","Order <- taxa[Yep, 'order']"
"0","Order[Order == """"] <- 'Unclassified Eukaryota'"
"0","Order[is.na(Order)] <- 'Unclassified Eukaryota'"
"0","mapfile$Order <- Order"
"0",""
"0","Genus <- taxa[Yep, 'genus']"
"0","Genus[Genus == """"] <- 'Unclassified Eukaryota'"
"0","Genus[is.na(Genus)] <- 'Unclassified Eukaryota'"
"0","mapfile$Genus <- Genus"
"0",""
"0","Species <- taxa[Yep, 'species']"
"0","Species[Species == """"] <- 'Unclassified Eukaryota'"
"0","Species[is.na(Species)] <- 'Unclassified Eukaryota'"
"0","mapfile$Species <- Species"
"0",""
"0","rm(Fam, Phylum, Yep, Kingdom, Supergroup, Class, Order, Genus, Species)"
"0",""
